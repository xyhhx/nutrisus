image: alpine/edge
sources:
  - https://git.sr.ht/~xyhhx/noodleapp#main
packages:
  - docker
secrets:
  - f17f24a9-ffbb-4366-9afc-b1a5cd9fe781
tasks:
  - set_up_docker: |
      sudo addgroup build docker
      sudo rc-service docker start
  - docker_login: |
      cat ~/.docker_hub_token | docker login -u xyhhx --password-stdin
  - build: |
      cd noodleapp
      make build push
  - release: |
      make release
